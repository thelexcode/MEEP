<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Area riservata</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="profile/style/profilo.css" rel="stylesheet">
    <link href="profile/style/nav.css" rel="stylesheet">
    <link href="profile/style/register.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <style>
        .fas.fa-eye {
            transform: translateY(30px);
        }

        .tooltip-container {

            cursor: pointer;
        }

        .tooltip-text {
            background-color: white;
            visibility: hidden;
            color: black;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            transform: translateX(30%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .tooltip-container:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        h2 {
            font-family: 'Playfair Display', serif;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .titcard {
            font-family: 'Playfair Display', serif;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .info {
            font-family: 'Montserrat', serif;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        }

        #profile-image {
            width: 150px;
            height: 150px;
        }
    </style>
</head>

<body>
    <div class="main-content">
        <!-- Top navbar -->
        <nav class="navbar navbar-top navbar-expand-md navbar-dark" id="navbar-main">
            <div class="container-fluid">
                <!-- Brand -->

                <!-- User -->
                <ul class="navbar-nav align-items-center">
                    <li class="nav-item dropdown">
                        <a class="nav-link pr-0" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <div class="d-flex align-items-center">


                            </div>
                        </a>
                    </li>
                </ul>




            </div>
        </nav>
        <!-- Header -->
        <div class="header pb-8 pt-5 pt-lg-8 d-flex align-items-center">
            <!-- Mask -->
            <span class="mask bg-gradient-default opacity-8"></span>
            <!-- Header container -->
            <div class="container-fluid d-flex align-items-center">
                <div class="row">
                    <div class="col-lg-7 col-md-10">
                        <h1 id=ciao class="display-2 text-white"></h1>
                        <p class="text-white mt-0 mb-5">Questa è la tua area riservata. Qui puoi modificare i tuoi dati
                            personali e vedere gli eventi che hai organizzato</p>

                    </div>
                </div>
            </div>
        </div>

        <!-- Page content -->
        <div class="container-fluid mt--7">
            <div class="row">

                <div class="col-xl-12 order-xl-1">
                    <div class="card ">
                        <div class="row justify-content-center">
                            <div class="col-lg-3 order-lg-2">
                                <div class="card-profile-image">
                                    <label for="image-upload" class="tooltip-container">
                                        <span class="tooltip-text">Modifica la tua immagine del profilo</span>
                                        <img id="profile-image"
                                          src="profile/img/depositphotos_199564354-stock-illustration-creative-vector-illustration-default-avatar.webp"
                                          class="rounded-circle">
                                        <input type="file" id="image-upload" accept="image/*" style="display: none;" onchange="foto(event)">
                                      </label>
                                      
                                </div>
                            </div>
                        </div>


                        <div class="card-header bg-white border-0">
                            <div class="row align-items-center">
                                <div class="col-8">
                                    <h3 class="mb-0">Il mio profilo</h3>
                                </div>
                                <div class="col-4 ">
                                    <div class="text-right">
                                        <a href="#!" class="btn btn-sm btn-primary" data-bs-toggle="modal"
                                            data-bs-target="#exampleModal">Modifica</a>
                                    </div>
                                    <!-- Button trigger modal -->
                                    <div class="modal" id="exampleModal" tabindex="-1"
                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title modal-title mx-auto" id="">
                                                        Modifica
                                                        il tuo
                                                        profilo</h5>
                                                    <button type="button" class="btn-close ms-2" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                </div>
                                                <!--Modal-->
                                                <div class="modal-body">
                                                    <form>
                                                        <h6 class="heading-small mb-4">User
                                                            information
                                                        </h6>
                                                        <div class="pl-lg-4">
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <div class="form-group focused">
                                                                        <label class="form-control-label"
                                                                            for="email">E-mail</label>
                                                                        <input type="email" id="email"
                                                                            class="form-control form-control-alternative"
                                                                            placeholder="" value="">
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-6">
                                                                    <div class="form-group focused">
                                                                        <label class="form-control-label"
                                                                            for="input-username">Username</label>
                                                                        <input type="text" id="input-username"
                                                                            class="form-control form-control-alternative"
                                                                            placeholder="" value="">
                                                                    </div>
                                                                </div>
                                                                <div class="col-lg-6">
                                                                    <div class="form-group">
                                                                        <label class="form-control-label"
                                                                            for="input-telefono">Telefono</label>
                                                                        <input type="tel" id="input-telefono"
                                                                            class="form-control form-control-alternative"
                                                                            placeholder="">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="password-container col-lg-12">
                                                                <div class="form-group">
                                                                    <label class="form-control-label"
                                                                        for="input-password">Password</label>
                                                                    <input type="password" id="password"
                                                                        oninput="strengthChecker()" class="input"
                                                                        placeholder="Password">
                                                                    <span id="toggle" onclick="toggle()">
                                                                        <i class="fas fa-eye"></i>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <div id="strength-bar"></div>
                                                            <p id="msg"></p>

                                                            <input type="password" id="cnfrm-password" class="input"
                                                                placeholder="Conferma la password">
                                                            <p id="message"></p>
                                                        </div>
                                                        <hr class="my-4">

                                                        <!-- Description -->
                                                        <h6 class="heading-small mb-4">Biografia</h6>
                                                        <div class="pl-lg-4">
                                                            <div class="form-group focused">
                                                                <label class="form-control-label">Biografia</label>
                                                                <textarea rows="4" id="biografia"
                                                                    class="form-control form-control-alternative"
                                                                    placeholder="Raccontaci qualcosa di te ..."></textarea>
                                                            </div>
                                                        </div>

                                                </div>

                                                <div class="modal-footer d-flex justify-content-center">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">Close</button>
                                                    <button type="submit" class="btn btn-primary"  onclick="edit()" id="liveToastBtn">Save
                                                        changes</button>
                                                </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <div class="card-body">

                            <h6 class="heading-small text-muted mb-4">Informazioni utente</h6>
                            <div class="pl-lg-4">
                                <div class="row">
                                    <div class="col-md-3 col-6">
                                        <h4>Matricola</h4>
                                        <p id="pmatricola"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Nome</h4>
                                        <p id="pnome"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Cognome</h4>
                                        <p id="pcognome"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Data di nascita</h4>
                                        <p id="pdataNascita"></p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3 col-6">
                                        <h4>E-mail</h4>
                                        <p id="pemail"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Username</h4>
                                        <p id="pusername"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Telefono</h4>
                                        <p id="ptelefono">/p>
                                    </div>
                                </div>
                            </div>
                            <hr class="my-4">




                            <div class="text-right">
                                <a href="#!" class="btn btn-sm btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#exampleModal2">Modifica</a>
                            </div>
                            <!-- Button trigger modal -->
                            <div class="modal" id="exampleModal2" tabindex="-1" aria-labelledby="exampleModalLabel"
                                aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title modal-title mx-auto" id="exampleModalLabel">
                                                Informazioni di recapito</h5>
                                            <button type="button" class="btn-close ms-2" data-bs-dismiss="modal"
                                                aria-label="Close"></button>
                                        </div>
                                        <!--Modal-->
                                        <div class="modal-body">
                                            <form>
                                                <h6 class="heading-small mb-4">Recapito
                                                </h6>
                                                <div class="pl-lg-4">
                                                    <div class="row">
                                                        <div class="col-lg-12">
                                                            <div class="form-group focused">
                                                                <label class="form-control-label"
                                                                    for="provincia">Provincia</label>
                                                                <input type="text" id="provincia"
                                                                    class="form-control form-control-alternative"
                                                                    placeholder="" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12">
                                                            <div class="form-group focused">
                                                                <label class="form-control-label"
                                                                    for="comune">Comune</label>
                                                                <input type="text" id="comune"
                                                                    class="form-control form-control-alternative"
                                                                    placeholder="" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12">
                                                            <div class="form-group focused">
                                                                <label class="form-control-label"
                                                                    for="Indirizzo">Indirizzo</label>
                                                                <input type="text" id="indirizzo"
                                                                    class="form-control form-control-alternative"
                                                                    placeholder="" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-lg-12">
                                                            <div class="form-group focused">
                                                                <label class="form-control-label" for="CAP">CAP</label>
                                                                <input type="text" id="cap"
                                                                    class="form-control form-control-alternative"
                                                                    placeholder="" value="">
                                                            </div>
                                                        </div>
                                                    </div>




                                                </div>


                                                <!-- Description -->

                                        </div>

                                        <div class="modal-footer d-flex justify-content-center">
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                            <button type="button" class="btn btn-primary" id="saveChangesBtn">Save changes</button>
                                          </div>
                                          

                                    </div>

                                </div>


                                </form>




                            </div>
                            <div class="pl-lg-4">
                                <div class="row">
                                    <div class="col-md-3 col-6">
                                        <h4>Provincia</h4>
                                        <p id="pprovincia"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Comune</h4>
                                        <p id="pcomune"></p>
                                    </div>
                                    <div class="col-md-3 col-6">
                                        <h4>Indirizzo</h4>
                                        <p id="pindirizzo"></p>
                                    </div>

                                    <div class="col-md-3 col-6">
                                        <h4>CAP</h4>
                                        <p id="pcap"></p>
                                    </div>
                                </div>
                            </div>
                            <hr class="my-4">




                            <div class="pl-lg-4">
                                <div class="col-lg-12">
                                    <h4>Biografia</h4>
                                    <p id="pbiografia">
                                        Mi chiamo Jessica Rossi e sono una dipendente
                                        appassionata e
                                        dinamica
                                        presso
                                        la vostra azienda. Con una laurea in gestione degli
                                        eventi,
                                        sono una
                                        vera
                                        esperta nell'organizzazione di eventi indimenticabili.
                                        La
                                        mia creatività
                                        e
                                        la mia meticolosa attenzione ai dettagli mi rendono la
                                        candidata ideale
                                        per
                                        guidare il vostro sito aziendale dedicato alla gestione
                                        degli eventi. Al
                                        di
                                        fuori del lavoro, adoro immergermi in nuove culture
                                        attraverso i viaggi
                                        e
                                        dedico il mio tempo al volontariato. La mia energia
                                        contagiosa e il mio
                                        amore per l'organizzazione renderanno il nostro sito un
                                        punto di
                                        riferimento
                                        per gli eventi aziendali straordinari.</p>
                                </div>
                            </div>

                        </div>
                    </div>
                    <hr class="my-4">
                    <h2>Eventi organizzati</h2>
                    <div class="album py-5 bg-body-tertiary">
                        <div class="container-fluid" style="margin-left: 0 !important; margin-right: 0 !important;">

                            <div id="eventi" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3 ">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    </div>
    </div>
    </div>
   

  <div class="container-fluid my-5 col-md-12 mb-md-0 p-0">
    <!-- Footer -->
    <footer class="text-center text-lg-start text-white p-0" style="background-color: #b2b7c0">
      <!-- Grid container -->
      <div class="container p-4 ">
        <!-- Section: Links -->
        <section class="">
          <!--Grid row-->
          <div class="row">
            <!-- Grid column -->
            <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">
                MEEP
              </h6>
              <p>
                L'app di eventi che non puoi perdere!"
Scopri, partecipa e vivi i migliori eventi della tua città con un semplice tocco!

              </p>
            </div>
            <!-- Grid column -->

            <hr class="w-100 clearfix d-md-none" />



            <hr class="w-100 clearfix d-md-none" />

            <!-- Grid column -->
            <hr class="w-100 clearfix d-md-none" />

            <!-- Grid column -->
            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Contatti</h6>
              <p><i class="fas fa-home mr-3"></i> Torino, To, 10024 IT</p>
              <p><i class="fas fa-envelope mr-3"></i> meep@info.com</p>
              <p><i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
              <p><i class="fas fa-print mr-3"></i> + 01 234 567 89</p>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Seguici</h6>

              <!-- Facebook -->
              <a class="btn btn-primary btn-floating rounded-circle m-1" style="background-color: #3b5998;
                            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;" href=" #!"
                role="button"><i class="fab fa-facebook-f"></i></a>

              <!-- Twitter -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #55acee; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-twitter"></i></a>

              <!-- Google -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #dd4b39; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-google"></i></a>

              <!-- Instagram -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #ac2bac;box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-instagram"></i></a>

              <!-- Linkedin -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #0082ca;box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-linkedin-in"></i></a>
              <!-- WhatsApp -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #25D366; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-whatsapp"></i></a>

            </div>
          </div>
          <!--Grid row-->
        </section>
        <!-- Section: Links -->
      </div>
      <!-- Grid container -->

      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2); ">
        <p style="transform: translateX(-35px);">© 2023 MEEP</p>
      </div>

      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </div>

    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>
    <script src="profile/script/data.js"></script>
    <script src="profile/script/script.js"></script>
    <script src="profile/script/password.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.all.min.js"></script>
    <script>
        const toastTrigger = document.getElementById('liveToastBtn')
        const toastLiveExample = document.getElementById('liveToast')
        document.getElementById("saveChangesBtn").addEventListener("click", function(event) {
            indirizzo(); 
});



        if (toastTrigger) {
            const toastBootstrap = bootstrap.Toast.getOrCreateInstance(toastLiveExample)
            toastTrigger.addEventListener('click', () => {
                toastBootstrap.show()
            })
        }
    </script>
 <script>
      function foto(event) {
     
        var fileInput = event.target;
        var file = fileInput.files[0]; // Ottieni il file dell'immagine

        var formData = new FormData();
        formData.append("file", file);

        fetch("http://localhost:8090/user/edit-foto", {
          method: "POST",
          headers: {
            "Access-Control-Allow-Origin": "*",
            Authorization: token,
          },
          body: formData, // Invia l'oggetto FormData contenente l'immagine
        })
          .then((response) => {
            if (response.ok) {
                
                window.location.href = window.location.href;
            } else {
              throw new Error(
                "Errore nella richiesta. Stato: " + response.status
              );
            }
          })
          

          .catch((error) => {
            console.error("Si è verificato un errore:", error);
          });
      }


      function edit() {
        
        var username = document.getElementById("input-username").value;
        var biografia = document.getElementById("biografia").value;
        var NewPassword = document.getElementById("password").value;
        var checkPassword = document.getElementById("cnfrm-password").value;
        var email = document.getElementById("email").value;
        var telefono = document.getElementById("input-telefono").value;
       

        var data = {
          username: username,
          biografia: biografia,
          newPassword: NewPassword,
          checkPassword: checkPassword,
          email:email,
          telefono:telefono
        };


        fetch("http://localhost:8090/user/edit", {
          method: "PUT",
          headers: {
            "Content-Type": "application/json",
            "Access-Control-Allow-Origin": "*",
            Authorization: token,
          },
          body: JSON.stringify(data),
        })
          .then((response) => {
            if (response.ok) {
                window.location.href = window.location.href;
            } else {
              throw new Error(
                "Errore nella richiesta. Stato: " + response.status
              );
            }
          })

          .catch((error) => {
            console.error("Si è verificato un errore:", error);
          })
        }

        function indirizzo() {
        var via = document.getElementById("indirizzo").value;
        var cap = document.getElementById("cap").value;
        var provincia = document.getElementById("provincia").value;
        var comune= document.getElementById("comune").value;
       
       

        var data = {
          via: via,
          cap: cap,
          provincia: provincia,
          comune: comune,
          
        };

        fetch("http://localhost:8090/user/indirizzo/edit", {
  method: "PUT",
  headers: {
    "Content-Type": "application/json",
    "Access-Control-Allow-Origin": "*",
    Authorization: token,
  },
  body: JSON.stringify(data),
})
  .then((response) => {
    if (response.ok) {
      Swal.fire({
        icon: "success",
        title: "Dati modificati con successo!",
        showConfirmButton: false, 
        timer: 1000, 
      })
      
    } else {
      throw new Error("Errore nella richiesta. Stato: " + response.status);
    }
  })
  .then(()=> {
    window.location.href = window.location.href;
      })
  .catch((error) => {
    console.error("Si è verificato un errore:", error);
  });



}
    </script>
  </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

</body>

</html>
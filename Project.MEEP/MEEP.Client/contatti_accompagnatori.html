<!DOCTYPE html>
<html>
  <head>
    <title>Event Planning</title>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    />
    <link
      rel="canonical"
      href="https://getbootstrap.com/docs/5.3/examples/album/"
    />
  </head>

  <body>
    <header>
      <nav
        class="navbar navbar-dark bg-primary"
        aria-label="First navbar example"
      >
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">MEEP</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarsExample01"
            aria-controls="navbarsExample01"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse" id="navbarsExample01">
            <ul class="navbar-nav me-auto mb-2">
              <li class="nav-item">
                <a class="nav-link" href="creaevento.html">Crea evento</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="areariservata.html">Area utente</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="index.html">Home</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <div class="container">
      <div class="py-5 text-center">
        <a href="" style="display: inline-block">
          <img
            class="d-block mx-auto mb-4"
            src="media/MEEP.png"
            alt=""
            width="72"
            height="100"
          />
        </a>
        <h2>
          Esperienze straordinarie in compagnia: scegli fino a cinque
          accompagnatori per i tuoi eventi aziendali!
        </h2>
        <p class="lead mt-4">
          Rendi i tuoi eventi aziendali indimenticabili con il potere della
          condivisione! La nostra pagina ti permette di selezionare fino a
          cinque accompagnatori, dando vita a momenti di connessione,
          divertimento e successo. Scegli le persone che più ti ispirano e
          creiamo insieme esperienze uniche per il tuo team. Sia che si tratti
          di una serata di gala, una giornata all'aria aperta o un'avventura
          emozionante, la tua scelta di accompagnatori porterà un tocco speciale
          che renderà ogni evento memorabile. Preparati a condividere risate,
          sorrisi e successi insieme a chi conta di più per te e la tua azienda!
        </p>
      </div>
      <form>
        <div class="form-group">
          <div class="form-block">
            <label for="ora-evento">Scegli il numero di accompagnatori:</label>
            <input
              type="number"
              class="form-control"
              id="ora-evento"
              placeholder=""
              value="0"
              required
              min="0"
              max="5"
            />
          </div>

          <hr class="my-4" />

          <div id="formContainer">
            
          </div>
        </div>
        <button type="submit" class="btn btn-primary col-sm-12">Invia</button>
      </form>
    </div>
    

  <div class="container-fluid my-5 col-md-12 mb-md-0 p-0">
    <!-- Footer -->
    <footer class="text-center text-lg-start text-white p-0" style="background-color: #b2b7c0">
      <!-- Grid container -->
      <div class="container p-4 ">
        <!-- Section: Links -->
        <section class="">
          <!--Grid row-->
          <div class="row">
            <!-- Grid column -->
            <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">
                MEEP
              </h6>
              <p>
                L'app di eventi che non puoi perdere!"
Scopri, partecipa e vivi i migliori eventi della tua città con un semplice tocco!

              </p>
            </div>
            <!-- Grid column -->

            <hr class="w-100 clearfix d-md-none" />



            <hr class="w-100 clearfix d-md-none" />

            <!-- Grid column -->
            <hr class="w-100 clearfix d-md-none" />

            <!-- Grid column -->
            <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Contatti</h6>
              <p><i class="fas fa-home mr-3"></i> Torino, To, 10024 IT</p>
              <p><i class="fas fa-envelope mr-3"></i>meep@info.com</p>
              <p><i class="fas fa-phone mr-3"></i> + 01 234 567 88</p>
              <p><i class="fas fa-print mr-3"></i> + 01 234 567 89</p>
            </div>
            <!-- Grid column -->

            <!-- Grid column -->
            <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
              <h6 class="text-uppercase mb-4 font-weight-bold">Seguici</h6>

              <!-- Facebook -->
              <a class="btn btn-primary btn-floating rounded-circle m-1" style="background-color: #3b5998;
                            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;" href=" #!"
                role="button"><i class="fab fa-facebook-f"></i></a>

              <!-- Twitter -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #55acee; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-twitter"></i></a>

              <!-- Google -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #dd4b39; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-google"></i></a>

              <!-- Instagram -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #ac2bac;box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-instagram"></i></a>

              <!-- Linkedin -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #0082ca;box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-linkedin-in"></i></a>
              <!-- WhatsApp -->
              <a class="btn btn-primary btn-floating rounded-circle m-1"
                style="background-color: #25D366; box-shadow: 0 0 5px rgba(0, 0, 0, 0.3); border: none !important;"
                href="#!" role="button"><i class="fab fa-whatsapp"></i></a>

            </div>
          </div>
          <!--Grid row-->
        </section>
        <!-- Section: Links -->
      </div>
      <!-- Grid container -->

      <!-- Copyright -->
      <div class="text-center p-3" style="background-color: rgba(0, 0, 0, 0.2); ">
        <p style="transform: translateX(-35px);">© 2023 MEEP</p>
      </div>

      <!-- Copyright -->
    </footer>
    <!-- Footer -->
  </div>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // Ottenere il riferimento agli elementi del DOM
      var formContainer = document.getElementById("formContainer");
      var accompagnatoriInput = document.getElementById("ora-evento");

      // Aggiungere un gestore di eventi per l'input del numero di accompagnatori
      accompagnatoriInput.addEventListener("input", function () {
        var numeroAccompagnatori = accompagnatoriInput.value;

        // Rimuovere tutti i campi "Nome" ed "Email" esistenti
        while (formContainer.firstChild) {
          formContainer.removeChild(formContainer.firstChild);
        }

        // Aggiungere i nuovi campi "Nome" ed "Email" in base al numero di accompagnatori
        for (var i = 1; i <= numeroAccompagnatori; i++) {
          var formBlock = document.createElement("div");
          formBlock.className = "form-block";

          var formRow = document.createElement("div");
          formRow.className = "form-row";

          var formGroup1 = document.createElement("div");
          formGroup1.className = "form-group col-sm-6";

          var label1 = document.createElement("label");
          label1.setAttribute("for", "nome" + i);
          label1.textContent = "Nome";

          var nomeInput = document.createElement("input");
          nomeInput.type = "text";
          nomeInput.className = "form-control";
          nomeInput.id = "nome" + i;
          nomeInput.name = "nome" + i;
          nomeInput.required = true; // Aggiunto l'attributo required

          var formGroup2 = document.createElement("div");
          formGroup2.className = "form-group col-sm-6";

          var label2 = document.createElement("label");
          label2.setAttribute("for", "email" + i);
          label2.textContent = "Email";

          var emailInput = document.createElement("input");
          emailInput.type = "email";
          emailInput.className = "form-control";
          emailInput.id = "email" + i;
          emailInput.name = "email" + i;
          emailInput.required = true; // Aggiunto l'attributo required

          formGroup1.appendChild(label1);
          formGroup1.appendChild(nomeInput);
          formGroup2.appendChild(label2);
          formGroup2.appendChild(emailInput);
          formRow.appendChild(formGroup1);
          formRow.appendChild(formGroup2);
          formBlock.appendChild(formRow);
          formContainer.appendChild(formBlock);
        }
      });
    </script>
    

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.18/dist/sweetalert2.all.min.js"></script>
   
    <script>
      const form = document.querySelector("form");
      var params = new URLSearchParams(window.location.search);
      const url = "http://localhost:8090/partecipazione/qr"; 

      form.addEventListener("submit", (event) => {
        event.preventDefault(); // Evita l'invio del modulo tradizionale

        const codice_evento = params.get("evento");
        const n_accompagnatoriInput = form.querySelector("#ora-evento");
        const n_accompagnatori = parseInt(n_accompagnatoriInput.value);
        const nomiAccompagnatori = [];
        const emailAccompagnatori = [];

        for (let i = 1; i <= n_accompagnatori; i++) {
          const nomeInput = form.querySelector(`#nome${i}`);
          const emailInput = form.querySelector(`#email${i}`);
          nomiAccompagnatori.push(nomeInput.value);
          emailAccompagnatori.push(emailInput.value);
        }

        // Costruisci l'oggetto dei dati da inviare al backend
        const data = {
          codice_evento: codice_evento,
          n_accompagnatori: n_accompagnatori,
          nomiAccompagnatori: nomiAccompagnatori,
          emailAccompagnatori: emailAccompagnatori,
        };

        
        var token = localStorage.getItem("token");
        // Esegui la richiesta fetch
        fetch(url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "Access-Control-Allow-Origin": "*",
            Authorization: token,
          },
          body: JSON.stringify(data),
        })
    .then(response => {
      if (response.ok) {
        // Notifica di successo usando Swal.fire
        Swal.fire({
          icon: "success",
          title: "Evento registrato con successo!",
          showConfirmButton: true,
        }).then((result) => {
          if (result.isConfirmed) {
            window.location.href = "index.html";
          }
        });
      } else {
        throw new Error('Errore durante la richiesta');
      }
    })
    .catch(error => {
      // Gestisci eventuali errori durante la richiesta
      console.error('Errore durante la richiesta:', error);
      // Visualizza un messaggio di errore all'utente
    });
});
    </script>

<script>
  // Ottenere il riferimento agli elementi del DOM
  var formContainer = document.getElementById('formContainer');
  var accompagnatoriInput = document.getElementById('ora-evento');

  // Aggiungere un gestore di eventi per l'input del numero di accompagnatori
  accompagnatoriInput.addEventListener('input', function () {
      var numeroAccompagnatori = accompagnatoriInput.value;

      // Rimuovere tutti i campi "Nome" ed "Email" esistenti
      while (formContainer.firstChild) {
          formContainer.removeChild(formContainer.firstChild);
      }

      // Aggiungere i nuovi campi "Nome" ed "Email" in base al numero di accompagnatori
      for (var i = 1; i <= numeroAccompagnatori; i++) {
          var formBlock = document.createElement('div');
          formBlock.className = 'form-block';

          var formRow = document.createElement('div');
          formRow.className = 'form-row';

          var formGroup1 = document.createElement('div');
          formGroup1.className = 'form-group col-sm-6';

          var label1 = document.createElement('label');
          label1.setAttribute('for', 'nome' + i);
          label1.textContent = 'Nome';

          var nomeInput = document.createElement('input');
          nomeInput.type = 'text';
          nomeInput.className = 'form-control';
          nomeInput.id = 'nome' + i;
          nomeInput.name = 'nome' + i;
          nomeInput.required = true; // Aggiunto l'attributo required

          var formGroup2 = document.createElement('div');
          formGroup2.className = 'form-group col-sm-6';

          var label2 = document.createElement('label');
          label2.setAttribute('for', 'email' + i);
          label2.textContent = 'Email';

          var emailInput = document.createElement('input');
          emailInput.type = 'email';
          emailInput.className = 'form-control';
          emailInput.id = 'email' + i;
          emailInput.name = 'email' + i;
          emailInput.required = true; // Aggiunto l'attributo required

          formGroup1.appendChild(label1);
          formGroup1.appendChild(nomeInput);
          formGroup2.appendChild(label2);
          formGroup2.appendChild(emailInput);
          formRow.appendChild(formGroup1);
          formRow.appendChild(formGroup2);
          formBlock.appendChild(formRow);
          formContainer.appendChild(formBlock);
      }


  });

</script>
    <script src="../assets/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.1.0/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </body>
</html>
